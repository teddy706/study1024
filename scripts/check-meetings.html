<!DOCTYPE html>
<html>
<head>
    <title>λ―Έν… λ°μ΄ν„° ν™•μΈ</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>λ―Έν… λ°μ΄ν„° ν™•μΈ λ° μƒμ„±</h1>
    <div id="result"></div>
    
    <script>
        // Supabase ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” (μ‹¤μ  κ°’μΌλ΅ λ³€κ²½ν•΄μ•Ό ν•¨)
        const supabaseUrl = 'YOUR_SUPABASE_URL'
        const supabaseKey = 'YOUR_SUPABASE_ANON_KEY'
        
        // μ‹¤μ  ν™κ²½μ—μ„λ” μ•„λ κ°’λ“¤μ„ ν™•μΈν•μ„Έμ”
        console.log('ν™κ²½ λ³€μ ν™•μΈ:')
        console.log('VITE_SUPABASE_URL:', import.meta?.env?.VITE_SUPABASE_URL)
        console.log('VITE_SUPABASE_KEY:', import.meta?.env?.VITE_SUPABASE_KEY)
        
        async function checkMeetingData() {
            try {
                const resultDiv = document.getElementById('result')
                resultDiv.innerHTML = '<p>ν™•μΈ μ¤‘...</p>'
                
                // κ°λ°μ λ„κµ¬μ—μ„ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
                if (typeof window.supabase === 'undefined') {
                    resultDiv.innerHTML = `
                        <h2>β Supabase ν΄λΌμ΄μ–ΈνΈκ°€ μ—†μµλ‹λ‹¤</h2>
                        <p>μ΄ μ¤ν¬λ¦½νΈλ” μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‹¤ν–‰ μ¤‘μΈ λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.</p>
                        <p>λ‹¤μ λ‹¨κ³„λ¥Ό λ”°λΌν•μ„Έμ”:</p>
                        <ol>
                            <li>npm run devλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•μ„Έμ”</li>
                            <li>λΈλΌμ°μ €μ—μ„ http://localhost:5173μ— μ ‘μ†ν•μ„Έμ”</li>
                            <li>κ°λ°μ λ„κµ¬(F12)λ¥Ό μ—΄κ³  Console νƒ­μΌλ΅ μ΄λ™ν•μ„Έμ”</li>
                            <li>μ•„λ μ¤ν¬λ¦½νΈλ¥Ό λ³µμ‚¬ν•΄μ„ μ‹¤ν–‰ν•μ„Έμ”:</li>
                        </ol>
                        <pre style="background: #f5f5f5; padding: 10px; margin: 10px 0;">
// λ―Έν… λ°μ΄ν„° ν™•μΈ
async function checkMeetings() {
    if (!window.supabase) {
        console.error('Supabase ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.');
        return;
    }
    
    console.log('π” ν„μ¬ μ‚¬μ©μ ν™•μΈ...');
    const { data: { user }, error: authError } = await window.supabase.auth.getUser();
    
    if (authError || !user) {
        console.error('μΈμ¦μ΄ ν•„μ”ν•©λ‹λ‹¤:', authError);
        return;
    }
    
    console.log('π‘¤ μ‚¬μ©μ ID:', user.id);
    
    // μ—°λ½μ² ν™•μΈ
    console.log('π“‹ μ—°λ½μ² ν™•μΈ...');
    const { data: contacts, error: contactError } = await window.supabase
        .from('contacts')
        .select('id, name')
        .eq('user_id', user.id);
    
    if (contactError) {
        console.error('μ—°λ½μ² μ΅°ν μ‹¤ν¨:', contactError);
        return;
    }
    
    console.log('π“‹ μ—°λ½μ² μ:', contacts?.length || 0);
    contacts?.forEach((contact, index) => {
        console.log(\`  \${index + 1}. \${contact.name} (ID: \${contact.id})\`);
    });
    
    if (contacts && contacts.length > 0) {
        // μ²« λ²μ§Έ μ—°λ½μ²μ λ―Έν… ν™•μΈ
        const contact = contacts[0];
        console.log(\`\\nπ“ "\${contact.name}"μ λ―Έν… ν™•μΈ...\`);
        
        const { data: meetings, error: meetingError } = await window.supabase
            .from('meetings')
            .select('*')
            .eq('contact_id', contact.id)
            .order('met_at', { ascending: false });
        
        if (meetingError) {
            console.error('λ―Έν… μ΅°ν μ‹¤ν¨:', meetingError);
            return;
        }
        
        console.log('π“ λ―Έν… μ:', meetings?.length || 0);
        meetings?.forEach((meeting, index) => {
            console.log(\`  \${index + 1}. \${new Date(meeting.met_at).toLocaleDateString()}: \${meeting.memo?.substring(0, 50)}...\`);
        });
        
        if (!meetings || meetings.length === 0) {
            console.log('\\nπ’΅ λ―Έν…μ΄ μ—†μµλ‹λ‹¤. ν…μ¤νΈ λ―Έν…μ„ μƒμ„±ν•λ ¤λ©΄ λ‹¤μ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•μ„Έμ”:');
            console.log('createSimpleTestMeetings()');
        }
    } else {
        console.log('\\nπ’΅ μ—°λ½μ²κ°€ μ—†μµλ‹λ‹¤. λ¨Όμ € μ—°λ½μ²λ¥Ό μƒμ„±ν•΄μ£Όμ„Έμ”.');
    }
}

// ν•¨μ μ‹¤ν–‰
checkMeetings();
                        </pre>
                    `
                    return
                }
                
                // μ‹¤μ  ν™•μΈ λ΅μ§μ€ μ„μ μ¤ν¬λ¦½νΈλ¥Ό μ½μ†”μ—μ„ μ‹¤ν–‰
                
            } catch (error) {
                console.error('μ¤λ¥:', error)
                document.getElementById('result').innerHTML = `<p>μ¤λ¥: ${error.message}</p>`
            }
        }
        
        // νμ΄μ§€ λ΅λ“ μ‹ μ‹¤ν–‰
        checkMeetingData()
    </script>
</body>
</html>